@import "tailwindcss";
@import "tw-animate-css";

@custom-variant dark (&:is(.dark *));

@theme inline {
  /* 基础背景色变量映射 */
  --color-background: var(--background);
  /* 基础文字色变量映射 */  
  --color-foreground: var(--foreground);

  /* 无衬线字体变量（使用Geist字体） */
  --font-sans: var(--font-geist-sans);
  /* 等宽字体变量（使用Geist Mono字体） */
  --font-mono: var(--font-geist-mono);

  /* 侧边栏相关变量映射 */
  --color-sidebar-ring: var(--sidebar-ring);       /* 侧边栏焦点环颜色 */
  --color-sidebar-border: var(--sidebar-border);   /* 侧边栏边框颜色 */
  --color-sidebar-accent-foreground: var(--sidebar-accent-foreground); /* 侧边栏强调文字色 */
  --color-sidebar-accent: var(--sidebar-accent);   /* 侧边栏强调色 */
  --color-sidebar-primary-foreground: var(--sidebar-primary-foreground); /* 侧边栏主按钮文字色 */
  --color-sidebar-primary: var(--sidebar-primary); /* 侧边栏主按钮色 */
  --color-sidebar-foreground: var(--sidebar-foreground); /* 侧边栏文字色 */
  --color-sidebar: var(--sidebar);                 /* 侧边栏背景色 */

  /* 图表颜色变量映射 */
  --color-chart-5: var(--chart-5);  /* 图表第五系列颜色 */
  --color-chart-4: var(--chart-4);  /* 图表第四系列颜色 */
  --color-chart-3: var(--chart-3);  /* 图表第三系列颜色 */
  --color-chart-2: var(--chart-2);  /* 图表第二系列颜色 */
  --color-chart-1: var(--chart-1);  /* 图表第一系列颜色 */

  /* 交互元素变量映射 */
  --color-ring: var(--ring);        /* 焦点环颜色 */
  --color-input: var(--input);      /* 输入框背景色 */
  --color-border: var(--border);    /* 通用边框颜色 */
  --color-destructive: var(--destructive); /* 错误/危险操作颜色 */

  /* 强调色系变量映射 */
  --color-accent-foreground: var(--accent-foreground); /* 强调文字色 */
  --color-accent: var(--accent);     /* 强调色 */

  /* 次要内容变量映射 */
  --color-muted-foreground: var(--muted-foreground); /* 次要文字色 */
  --color-muted: var(--muted);       /* 次要背景色 */

  /* 次级内容变量映射 */  
  --color-secondary-foreground: var(--secondary-foreground); /* 次级文字色 */
  --color-secondary: var(--secondary); /* 次级背景色 */

  /* 主色系变量映射 */
  --color-primary-foreground: var(--primary-foreground); /* 主按钮文字色 */
  --color-primary: var(--primary);   /* 主按钮色 */

  /* 弹出层变量映射 */
  --color-popover-foreground: var(--popover-foreground); /* 弹出层文字色 */
  --color-popover: var(--popover);   /* 弹出层背景色 */

  /* 卡片组件变量映射 */
  --color-card-foreground: var(--card-foreground); /* 卡片文字色 */
  --color-card: var(--card);         /* 卡片背景色 */

  /* 圆角系统变量计算 */
  --radius-sm: calc(var(--radius) - 4px);  /* 小圆角尺寸 */
  --radius-md: calc(var(--radius) - 2px);  /* 中圆角尺寸 */
  --radius-lg: var(--radius);              /* 大圆角尺寸（基准值） */
  --radius-xl: calc(var(--radius) + 4px);  /* 超大圆角尺寸 */
}

:root {
  /* 基础圆角大小 (10px) */
  --radius: 0.625rem;

  /* 基础背景色 - 纯白色 */
  --background: oklch(1 0 0);
  /* 基础文字色 - 深灰色 */
  --foreground: oklch(0.145 0 0);

  /* 卡片组件背景色 - 纯白色 */
  --card: oklch(1 0 0);
  /* 卡片文字色 - 深灰色 */
  --card-foreground: oklch(0.145 0 0);

  /* 弹出层背景色 - 纯白色 */
  --popover: oklch(1 0 0);
  /* 弹出层文字色 - 深灰色 */
  --popover-foreground: oklch(0.145 0 0);

  /* 主色调 - 深灰色 */
  --primary: oklch(0.205 0 0);
  /* 主色调上的文字色 - 接近白色 */
  --primary-foreground: oklch(0.985 0 0);

  /* 次级色调 - 浅灰色 */
  --secondary: oklch(0.97 0 0);
  /* 次级色调上的文字色 - 深灰色 */
  --secondary-foreground: oklch(0.205 0 0);

  /* 弱化内容背景色 - 浅灰色 */
  --muted: oklch(0.97 0 0);
  /* 弱化内容文字色 - 中灰色 */
  --muted-foreground: oklch(0.556 0 0);

  /* 强调色 - 浅灰色 */
  --accent: oklch(0.97 0 0);
  /* 强调色上的文字色 - 深灰色 */
  --accent-foreground: oklch(0.205 0 0);

  /* 错误/危险操作颜色 - 红色 */
  --destructive: oklch(0.577 0.245 27.325);

  /* 通用边框颜色 - 浅灰色 */
  --border: oklch(0.922 0 0);
  /* 输入框背景色 - 浅灰色 */
  --input: oklch(0.922 0 0);
  /* 焦点环颜色 - 中灰色 */
  --ring: oklch(0.708 0 0);

  /* 图表颜色系列 */
  --chart-1: oklch(0.646 0.222 41.116);  /* 橙色系 */
  --chart-2: oklch(0.6 0.118 184.704);   /* 蓝色系 */
  --chart-3: oklch(0.398 0.07 227.392);   /* 紫色系 */
  --chart-4: oklch(0.828 0.189 84.429);  /* 绿色系 */
  --chart-5: oklch(0.769 0.188 70.08);    /* 黄色系 */

  /* 侧边栏相关颜色 */
  --sidebar: oklch(0.985 0 0);            /* 侧边栏背景色 - 接近白色 */
  --sidebar-foreground: oklch(0.145 0 0); /* 侧边栏文字色 - 深灰色 */
  --sidebar-primary: oklch(0.205 0 0);    /* 侧边栏主按钮色 - 深灰色 */
  --sidebar-primary-foreground: oklch(0.985 0 0); /* 侧边栏主按钮文字色 - 接近白色 */
  --sidebar-accent: oklch(0.97 0 0);      /* 侧边栏强调色 - 浅灰色 */
  --sidebar-accent-foreground: oklch(0.205 0 0); /* 侧边栏强调色文字 - 深灰色 */
  --sidebar-border: oklch(0.922 0 0);     /* 侧边栏边框色 - 浅灰色 */
  --sidebar-ring: oklch(0.708 0 0);       /* 侧边栏焦点环色 - 中灰色 */
  --sidebar-background: oklch(0.98 0 0);  /* 侧边栏背景色 - 使用OKLCH颜色值，几乎纯白色 */
}

.dark {
  /* 暗黑模式背景色 - 深灰色 */
  --background: oklch(0.145 0 0);
  /* 暗黑模式文字色 - 接近白色 */
  --foreground: oklch(0.985 0 0);

  /* 暗黑模式卡片背景色 - 深灰色 */
  --card: oklch(0.205 0 0);
  /* 暗黑模式卡片文字色 - 接近白色 */
  --card-foreground: oklch(0.985 0 0);

  /* 暗黑模式弹出层背景色 - 深灰色 */
  --popover: oklch(0.205 0 0);
  /* 暗黑模式弹出层文字色 - 接近白色 */
  --popover-foreground: oklch(0.985 0 0);

  /* 暗黑模式主色调 - 接近白色 */
  --primary: oklch(0.922 0 0);
  /* 暗黑模式主色调文字色 - 深灰色 */
  --primary-foreground: oklch(0.205 0 0);

  /* 暗黑模式次级色调 - 深灰色 */
  --secondary: oklch(0.269 0 0);
  /* 暗黑模式次级色调文字色 - 接近白色 */
  --secondary-foreground: oklch(0.985 0 0);

  /* 暗黑模式弱化内容背景色 - 深灰色 */
  --muted: oklch(0.269 0 0);
  /* 暗黑模式弱化内容文字色 - 中灰色 */
  --muted-foreground: oklch(0.708 0 0);

  /* 暗黑模式强调色 - 深灰色 */
  --accent: oklch(0.269 0 0);
  /* 暗黑模式强调色文字色 - 接近白色 */
  --accent-foreground: oklch(0.985 0 0);

  /* 暗黑模式错误/危险操作颜色 - 红色 */
  --destructive: oklch(0.704 0.191 22.216);

  /* 暗黑模式通用边框颜色 - 半透明白色 */
  --border: oklch(1 0 0 / 10%);
  /* 暗黑模式输入框背景色 - 半透明白色 */
  --input: oklch(1 0 0 / 15%);
  /* 暗黑模式焦点环颜色 - 中灰色 */
  --ring: oklch(0.556 0 0);

  /* 暗黑模式图表颜色系列 */
  --chart-1: oklch(0.488 0.243 264.376);  /* 紫色系 */
  --chart-2: oklch(0.696 0.17 162.48);    /* 蓝色系 */
  --chart-3: oklch(0.769 0.188 70.08);     /* 黄色系 */
  --chart-4: oklch(0.627 0.265 303.9);    /* 紫色系 */
  --chart-5: oklch(0.645 0.246 16.439);    /* 红色系 */

  /* 暗黑模式侧边栏相关颜色 */
  --sidebar: oklch(0.205 0 0);            /* 侧边栏背景色 - 深灰色 */
  --sidebar-foreground: oklch(0.985 0 0);  /* 侧边栏文字色 - 接近白色 */
  --sidebar-primary: oklch(0.488 0.243 264.376); /* 侧边栏主按钮色 - 紫色 */
  --sidebar-primary-foreground: oklch(0.985 0 0); /* 侧边栏主按钮文字色 - 接近白色 */
  --sidebar-accent: oklch(0.269 0 0);      /* 侧边栏强调色 - 深灰色 */
  --sidebar-accent-foreground: oklch(0.985 0 0); /* 侧边栏强调色文字 - 接近白色 */
  --sidebar-border: oklch(1 0 0 / 10%);    /* 侧边栏边框色 - 半透明白色 */
  --sidebar-ring: oklch(0.556 0 0);       /* 侧边栏焦点环色 - 中灰色 */
  --sidebar-background: oklch(0.205 0 0);  /* 侧边栏背景色 - 使用OKLCH颜色值，几乎深灰色 */
}

@layer base {
  * {
    @apply border-border outline-ring/50;
  }
  body {
    @apply bg-background text-foreground;
  }
}

/* 自定义细滚动条样式 */
.custom-scrollbar {
  /* Firefox 浏览器 */
  scrollbar-width: thin;
  scrollbar-color: #d1d5db transparent;
}

/* WebKit 浏览器 (Chrome, Safari, Edge) */
.custom-scrollbar::-webkit-scrollbar {
  width: 1px;
}

.custom-scrollbar::-webkit-scrollbar-track {
  background: transparent;
}

.custom-scrollbar::-webkit-scrollbar-thumb {
  background: #d1d5db;
  border-radius: 1px;
}

.custom-scrollbar::-webkit-scrollbar-thumb:hover {
  background: #9ca3af;
}

/* 修复代码块在移动端的溢出问题 */
.prose pre {
  @apply overflow-x-auto;
  max-width: 100%;
}

.prose code {
  @apply break-words;
}

/* 确保 prose 内容不会导致水平溢出 */
.prose {
  overflow-wrap: break-word;
  word-wrap: break-word;
  word-break: break-word;
  hyphens: auto;
}

.prose * {
  max-width: 100%;
  box-sizing: border-box;
}

/* 修复图片和媒体导致的溢出 */
.prose img,
.prose video,
.prose audio,
.prose iframe,
.prose object,
.prose embed {
  max-width: 100%;
  height: auto;
}

/* 确保代码块内容可以水平滚动 */
.prose pre code {
  @apply overflow-x-auto;
  display: block;
  min-width: max-content;
}

/* 为长代码行添加水平滚动条 */
.prose code:not(pre code) {
  @apply break-all;
}

/* 修复表格在移动端的显示问题 */
.prose table {
  @apply w-full text-sm border-collapse;
  border-spacing: 0;
  border: 1px solid #e5e7eb;
  border-radius: 8px;
  overflow: hidden;
  min-width: 100%;
}

.prose thead {
  @apply bg-gray-50;
}

.prose th {
  @apply px-4 py-3 text-left font-semibold text-gray-900 border-b border-gray-200;
  white-space: nowrap;
}

.prose td {
  @apply px-4 py-3 text-gray-700 border-b border-gray-100;
  word-break: break-word;
  vertical-align: top;
}

.prose tbody tr:last-child td {
  @apply border-b-0;
}

.prose tbody tr:hover {
  @apply bg-gray-50;
}

/* 表格容器 - 与 mdx-components 的 table 组件配合 */
.prose > div[class*="overflow-x-auto"] {
  @apply rounded-lg border border-gray-200 bg-white;
  margin: 1.5rem 0;
  max-width: 100%;
}

.prose > div[class*="overflow-x-auto"]::-webkit-scrollbar {
  height: 6px;
}

.prose > div[class*="overflow-x-auto"]::-webkit-scrollbar-track {
  background: #f1f5f9;
  border-radius: 3px;
}

.prose > div[class*="overflow-x-auto"]::-webkit-scrollbar-thumb {
  background: #cbd5e1;
  border-radius: 3px;
}

.prose > div[class*="overflow-x-auto"]::-webkit-scrollbar-thumb:hover {
  background: #94a3b8;
}

/* 移动端表格优化 */
@media (max-width: 640px) {
  .prose pre {
    @apply text-xs;
    max-width: calc(100vw - 2rem);
    margin-left: -1rem;
    margin-right: -1rem;
    padding-left: 1rem;
    padding-right: 1rem;
    border-radius: 0;
  }

  .prose pre::-webkit-scrollbar {
    height: 4px;
  }

  .prose pre::-webkit-scrollbar-track {
    background: transparent;
  }

  .prose pre::-webkit-scrollbar-thumb {
    background: #d1d5db;
    border-radius: 2px;
  }

  .prose pre::-webkit-scrollbar-thumb:hover {
    background: #9ca3af;
  }

  /* 移动端表格容器优化 */
  .prose > div[class*="overflow-x-auto"] {
    margin-left: -1rem;
    margin-right: -1rem;
    max-width: calc(100vw + 2rem);
    border-radius: 0;
    border-left: none;
    border-right: none;
    -webkit-overflow-scrolling: touch;
  }

  /* 移动端表格样式 */
  .prose table {
    @apply text-xs;
    min-width: max-content;
  }

  .prose th,
  .prose td {
    @apply px-2 py-2;
    min-width: 80px;
    white-space: nowrap;
  }

  /* 移动端表格容器滚动条 */
  .prose > div[class*="overflow-x-auto"]::-webkit-scrollbar {
    height: 4px;
  }

  .prose > div[class*="overflow-x-auto"]::-webkit-scrollbar-track {
    background: transparent;
  }

  .prose > div[class*="overflow-x-auto"]::-webkit-scrollbar-thumb {
    background: #d1d5db;
    border-radius: 2px;
  }

  .prose > div[class*="overflow-x-auto"]::-webkit-scrollbar-thumb:hover {
    background: #9ca3af;
  }
}

/* 深色模式表格样式 */
.dark .prose thead {
  @apply bg-gray-800;
}

.dark .prose th {
  @apply text-gray-100 border-gray-700;
}

.dark .prose td {
  @apply text-gray-300 border-gray-700;
}

.dark .prose tbody tr:hover {
  @apply bg-gray-800;
}

.dark .prose table,
.dark .prose .table-wrapper {
  border-color: #374151;
}

/* 表格单元格内的代码样式 */
.prose td code,
.prose th code {
  @apply text-xs;
  background: transparent;
  padding: 0;
  border-radius: 0;
  font-weight: normal;
}

/* 响应式表格 - 备选方案 */
@media (max-width: 768px) {
  .prose .responsive-table {
    @apply block;
  }

  .prose .responsive-table thead,
  .prose .responsive-table tbody,
  .prose .responsive-table th,
  .prose .responsive-table td,
  .prose .responsive-table tr {
    @apply block;
  }

  .prose .responsive-table thead tr {
    @apply absolute;
    left: -9999px;
    top: -9999px;
  }

  .prose .responsive-table tr {
    @apply border border-gray-200 mb-6;
    border-radius: 8px;
  }

  .prose .responsive-table td {
    @apply border-none border-b border-gray-200 relative pl-24 pb-3 pt-3;
    text-align: left;
    white-space: normal;
  }

  .prose .responsive-table td:before {
    content: attr(data-label);
    @apply absolute left-4 top-3 font-semibold text-gray-900;
    white-space: nowrap;
  }
}

/* 管理后台移动端优化 */
@media (max-width: 640px) {
  /* 确保管理页面容器不会溢出 */
  .container {
    @apply px-3;
    max-width: 100%;
  }

  /* 标签页导航优化 */
  [role="tablist"] {
    @apply overflow-x-auto;
    -webkit-overflow-scrolling: touch;
  }

  /* 表格在移动端的优化 */
  table {
    @apply text-xs;
    display: block;
    overflow-x: auto;
    white-space: nowrap;
    -webkit-overflow-scrolling: touch;
  }

  /* 卡片内容优化 */
  .card-content {
    @apply px-3 py-4;
  }

  /* 表单元素优化 */
  input, textarea, select {
    @apply text-sm;
  }

  /* 按钮组优化 */
  .btn-group {
    @apply flex-col gap-2;
  }

  .btn-group > button {
    @apply w-full;
  }
}

/* 管理后台侧边栏移动端优化 */
@media (max-width: 1024px) {
  /* [data-sidebar="sidebar"] {
    @apply fixed inset-y-0 left-0 z-50;
  }

  [data-sidebar="sidebar"][data-state="collapsed"] {
    @apply -translate-x-full;
  }

  [data-sidebar="sidebar"][data-state="expanded"] {
    @apply translate-x-0;
  } */

  /* 文章列表表格移动端优化 */
  .article-list-table {
    @apply text-xs;
    display: block;
    overflow-x: auto;
    white-space: nowrap;
    -webkit-overflow-scrolling: touch;
  }

  .article-list-table th,
  .article-list-table td {
    @apply px-2 py-2;
    white-space: nowrap;
  }

  .article-list-table th:first-child,
  .article-list-table td:first-child {
    @apply min-w-[120px] max-w-[250px];
    width: 200px;
  }

  .article-list-table th:nth-child(2),
  .article-list-table td:nth-child(2) {
    @apply min-w-[60px] max-w-[80px];
  }

  .article-list-table th:nth-child(3),
  .article-list-table td:nth-child(3) {
    @apply min-w-[60px] max-w-[100px];
  }

  .article-list-table th:nth-child(n+4),
  .article-list-table td:nth-child(n+4) {
    @apply min-w-[50px] max-w-[60px];
  }

  .article-title-truncate {
    @apply line-clamp-2;
    overflow: hidden;
    display: -webkit-box;
    -webkit-line-clamp: 2;
    -webkit-box-orient: vertical;
  }

  /* 操作按钮移动端优化 */
  .article-actions {
    @apply flex flex-col gap-1 md:flex-row md:gap-1;
  }

  .article-actions button {
    @apply w-full md:w-auto justify-center text-xs md:text-sm;
  }

  /* 移动端隐藏非关键列 */
  @media (max-width: 640px) {
    .article-list-table th:nth-child(4),
    .article-list-table th:nth-child(5),
    .article-list-table td:nth-child(4),
    .article-list-table td:nth-child(5) {
      @apply hidden;
    }
  }

  /* 时间列在移动端显示为文本 */
  @media (max-width: 768px) {
    .article-list-table th:nth-child(6),
    .article-list-table td:nth-child(6) {
      @apply text-xs;
      white-space: normal;
      word-break: break-word;
    }
  }

  /* 标签移动端优化 */
  .article-tags {
    @apply flex flex-wrap gap-1;
  }

  .article-tags .badge {
    @apply text-xs px-1 py-0.5;
  }
}
