# è¯„è®ºç®¡ç† API æ–‡æ¡£

## æ¦‚è¿°

è¯„è®ºç®¡ç†æ¨¡å—æä¾›æ–‡ç« è¯„è®ºçš„æ·»åŠ å’ŒæŸ¥è¯¢åŠŸèƒ½ã€‚æ”¯æŒå¯¹æ–‡ç« è¿›è¡Œè¯„è®ºï¼Œè¯„è®ºéœ€è¦ç»è¿‡å®¡æ ¸åæ‰ä¼šå…¬å¼€æ˜¾ç¤ºã€‚ç³»ç»Ÿæ”¯æŒè¯„è®ºçš„çŠ¶æ€ç®¡ç†ã€é€šçŸ¥æœºåˆ¶ç­‰ç‰¹æ€§ã€‚

## API åˆ—è¡¨

### 1. æ·»åŠ è¯„è®º

ä¸ºæŒ‡å®šæ–‡ç« æ·»åŠ è¯„è®ºï¼Œè¯„è®ºéœ€è¦ç»è¿‡å®¡æ ¸åæ‰ä¼šå…¬å¼€æ˜¾ç¤ºã€‚

**æ¥å£è·¯å¾„**: `/api/v1/article_comment/add`
**HTTPæ–¹æ³•**: POST
**è®¤è¯**: æ— éœ€è®¤è¯ï¼ˆå¯é€‰ï¼Œç”¨äºå…³è”ç”¨æˆ·ï¼‰
**Content-Type**: application/json

#### è¯·æ±‚å‚æ•°

```json
{
  "article_title": "Goè¯­è¨€å¹¶å‘ç¼–ç¨‹å®è·µ",
  "comment": "è¿™ç¯‡æ–‡ç« å†™å¾—å¾ˆå¥½ï¼Œå¯¹goroutineçš„è§£é‡Šéå¸¸æ¸…æ™°ï¼Œæ„Ÿè°¢åˆ†äº«ï¼"
}
```

#### å­—æ®µè¯´æ˜

| å­—æ®µ | ç±»å‹ | å¿…å¡« | æè¿° | é™åˆ¶ |
|------|------|------|------|------|
| article_title | string | æ˜¯ | æ–‡ç« æ ‡é¢˜ï¼Œç”¨äºå…³è”æ–‡ç«  | æœ€å¤§200å­—ç¬¦ |
| comment | string | æ˜¯ | è¯„è®ºå†…å®¹ | æœ€å¤§1000å­—ç¬¦ |

#### å“åº”ç¤ºä¾‹

**æˆåŠŸå“åº” (200)**:
```json
{
  "code": 200,
  "msg": "è¯„è®ºæ·»åŠ æˆåŠŸ",
  "data": "è¯„è®ºå·²æ·»åŠ ï¼Œå¾…å®¡æ ¸åå°†ä¼šæ˜¾ç¤º"
}
```

**é”™è¯¯å“åº” (400)**:
```json
{
  "code": 20301,
  "msg": "æ·»åŠ è¯„è®ºå¤±è´¥",
  "data": "æ–‡ç« ä¸å­˜åœ¨æˆ–è¯„è®ºå†…å®¹ä¸ç¬¦åˆè§„èŒƒ"
}
```

### 2. è·å–è¯„è®ºåˆ—è¡¨

è·å–è¯„è®ºåˆ—è¡¨ï¼Œæ”¯æŒå¤šç§ç­›é€‰æ¡ä»¶å’Œæ’åºæ–¹å¼ã€‚ä¸»è¦ç”¨äºç®¡ç†å‘˜å®¡æ ¸è¯„è®ºã€‚

**æ¥å£è·¯å¾„**: `/api/v1/article_comment/list`
**HTTPæ–¹æ³•**: GET
**è®¤è¯**: æ— éœ€è®¤è¯
**Content-Type**: application/json

#### è¯·æ±‚å‚æ•°

| å‚æ•°å | ç±»å‹ | ä½ç½® | å¿…å¡« | é»˜è®¤å€¼ | æè¿° | ç¤ºä¾‹ |
|--------|------|------|------|--------|------|------|
| article_title | string | query | å¦ | - | æŒ‰æ–‡ç« æ ‡é¢˜ç­›é€‰ | "Goè¯­è¨€å¹¶å‘ç¼–ç¨‹å®è·µ" |
| is_notify | boolean | query | å¦ | - | æ˜¯å¦å·²å‘é€é€šçŸ¥ | true |
| is_read | boolean | query | å¦ | - | æ˜¯å¦å·²è¯» | false |
| is_pass | boolean | query | å¦ | - | æ˜¯å¦é€šè¿‡å®¡æ ¸ | true |
| notify_desc | boolean | query | å¦ | false | æŒ‰é€šçŸ¥æ—¶é—´å€’åº | true |
| read_desc | boolean | query | å¦ | false | æŒ‰è¯»å–æ—¶é—´å€’åº | true |
| pass_desc | boolean | query | å¦ | false | æŒ‰å®¡æ ¸æ—¶é—´å€’åº | true |
| page | int | query | å¦ | 1 | é¡µç  | 2 |
| page_size | int | query | å¦ | 20 | æ¯é¡µæ•°é‡ | 50 |

#### ç­›é€‰æ¡ä»¶è¯´æ˜

- `article_title`: ç²¾ç¡®åŒ¹é…æ–‡ç« æ ‡é¢˜
- `is_notify`: trueè¡¨ç¤ºå·²å‘é€é‚®ä»¶é€šçŸ¥ç»™ä½œè€…ï¼Œfalseè¡¨ç¤ºæœªå‘é€
- `is_read`: trueè¡¨ç¤ºè¯„è®ºå·²è¢«å¤„ç†ï¼ˆå·²è¯»ï¼‰ï¼Œfalseè¡¨ç¤ºå¾…å¤„ç†ï¼ˆæœªè¯»ï¼‰
- `is_pass`: trueè¡¨ç¤ºå·²é€šè¿‡å®¡æ ¸ï¼ˆå…¬å¼€æ˜¾ç¤ºï¼‰ï¼Œfalseè¡¨ç¤ºå¾…å®¡æ ¸æˆ–æœªé€šè¿‡

#### æ’åºè¯´æ˜

- `notify_desc`: æŒ‰é€šçŸ¥æ—¶é—´å€’åºæ’åˆ—ï¼ˆæœ€æ–°é€šçŸ¥åœ¨å‰ï¼‰
- `read_desc`: æŒ‰è¯»å–æ—¶é—´å€’åºæ’åˆ—ï¼ˆæœ€æ–°è¯»å–åœ¨å‰ï¼‰
- `pass_desc`: æŒ‰å®¡æ ¸æ—¶é—´å€’åºæ’åˆ—ï¼ˆæœ€æ–°å®¡æ ¸åœ¨å‰ï¼‰

#### å“åº”ç¤ºä¾‹

**æˆåŠŸå“åº” (200)**:
```json
{
  "code": 200,
  "msg": "è·å–æˆåŠŸ",
  "data": [
    {
      "id": "comment-001",
      "article_title": "Goè¯­è¨€å¹¶å‘ç¼–ç¨‹å®è·µ",
      "content": "è¿™ç¯‡æ–‡ç« å†™å¾—å¾ˆå¥½ï¼Œå¯¹goroutineçš„è§£é‡Šéå¸¸æ¸…æ™°ï¼Œæ„Ÿè°¢åˆ†äº«ï¼",
      "is_notify": true,
      "is_read": false,
      "is_pass": true,
      "user_name": "reader123",
      "user_email": "reader@example.com",
      "ip_address": "192.168.1.1",
      "user_agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36",
      "created_at": "2024-01-01T10:30:00Z",
      "updated_at": "2024-01-01T10:35:00Z",
      "notified_at": "2024-01-01T10:32:00Z",
      "passed_at": "2024-01-01T10:35:00Z"
    },
    {
      "id": "comment-002",
      "article_title": "å¾®æœåŠ¡æ¶æ„è®¾è®¡åŸåˆ™",
      "content": "èƒ½å¦è¯¦ç»†ä»‹ç»ä¸€ä¸‹æœåŠ¡å‘ç°æœºåˆ¶ï¼Ÿ",
      "is_notify": false,
      "is_read": true,
      "is_pass": false,
      "user_name": "tech_lover",
      "user_email": "tech@example.com",
      "ip_address": "192.168.1.2",
      "user_agent": "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36",
      "created_at": "2024-01-01T14:20:00Z",
      "updated_at": "2024-01-01T14:25:00Z"
    }
  ]
}
```

**é”™è¯¯å“åº” (500)**:
```json
{
  "code": 20302,
  "msg": "è·å–è¯„è®ºåˆ—è¡¨å¤±è´¥",
  "data": "æœåŠ¡å™¨å†…éƒ¨é”™è¯¯ï¼Œè¯·ç¨åé‡è¯•"
}
```

## æ•°æ®æ¨¡å‹è¯¦æƒ…

### ArticleCommentï¼ˆè¯„è®ºæ¨¡å‹ï¼‰

```json
{
  "id": "string (UUID)",
  "article_title": "string (æ–‡ç« æ ‡é¢˜)",
  "content": "string (è¯„è®ºå†…å®¹)",
  "user_name": "string (è¯„è®ºè€…ç”¨æˆ·åï¼Œå¯é€‰)",
  "user_email": "string (è¯„è®ºè€…é‚®ç®±ï¼Œå¯é€‰)",
  "ip_address": "string (è¯„è®ºè€…IPåœ°å€)",
  "user_agent": "string (è¯„è®ºè€…User-Agent)",
  "is_notify": "boolean (æ˜¯å¦å·²å‘é€é€šçŸ¥)",
  "is_read": "boolean (æ˜¯å¦å·²è¯»)",
  "is_pass": "boolean (æ˜¯å¦é€šè¿‡å®¡æ ¸)",
  "created_at": "datetime (åˆ›å»ºæ—¶é—´)",
  "updated_at": "datetime (æ›´æ–°æ—¶é—´)",
  "notified_at": "datetime (é€šçŸ¥æ—¶é—´ï¼Œå¯é€‰)",
  "passed_at": "datetime (å®¡æ ¸é€šè¿‡æ—¶é—´ï¼Œå¯é€‰)",
  "read_at": "datetime (è¯»å–æ—¶é—´ï¼Œå¯é€‰)"
}
```

## ä½¿ç”¨ç¤ºä¾‹

### æ·»åŠ è¯„è®º

```bash
# ä¸ºæ–‡ç« æ·»åŠ è¯„è®º
curl -X POST "http://127.0.0.1:9997/api/v1/article_comment/add" \
  -H "Content-Type: application/json" \
  -d '{
    "article_title": "Goè¯­è¨€å¹¶å‘ç¼–ç¨‹å®è·µ",
    "comment": "è¿™ç¯‡æ–‡ç« å†™å¾—å¾ˆå¥½ï¼Œå¯¹goroutineçš„è§£é‡Šéå¸¸æ¸…æ™°ï¼Œæ„Ÿè°¢åˆ†äº«ï¼"
  }'
```

```bash
# å¸¦ç”¨æˆ·ä¿¡æ¯çš„è¯„è®ºï¼ˆå¦‚æœå·²ç™»å½•ï¼‰
curl -X POST "http://127.0.0.1:9997/api/v1/article_comment/add" \
  -H "Authorization: Bearer $ACCESS_TOKEN" \
  -H "Content-Type: application/json" \
  -d '{
    "article_title": "å¾®æœåŠ¡æ¶æ„è®¾è®¡åŸåˆ™",
    "comment": "èƒ½å¦è¯¦ç»†ä»‹ç»ä¸€ä¸‹æœåŠ¡å‘ç°æœºåˆ¶ï¼Ÿ"
  }'
```

### è·å–è¯„è®ºåˆ—è¡¨

```bash
# è·å–æ‰€æœ‰è¯„è®º
curl -X GET "http://127.0.0.1:9997/api/v1/article_comment/list"

# è·å–å¾…å®¡æ ¸çš„è¯„è®º
curl -X GET "http://127.0.0.1:9997/api/v1/article_comment/list?is_pass=false&is_read=false"

# è·å–æŒ‡å®šæ–‡ç« çš„è¯„è®º
curl -X GET "http://127.0.0.1:9997/api/v1/article_comment/list?article_title=Goè¯­è¨€å¹¶å‘ç¼–ç¨‹å®è·µ"

# è·å–å·²é€šè¿‡çš„è¯„è®ºï¼ŒæŒ‰å®¡æ ¸æ—¶é—´å€’åº
curl -X GET "http://127.0.0.1:9997/api/v1/article_comment/list?is_pass=true&pass_desc=true"

# åˆ†é¡µè·å–è¯„è®º
curl -X GET "http://127.0.0.1:9997/api/v1/article_comment/list?page=2&page_size=10"

# è·å–æœªå‘é€é€šçŸ¥çš„è¯„è®º
curl -X GET "http://127.0.0.1:9997/api/v1/article_comment/list?is_notify=false"
```

## è¯„è®ºå®¡æ ¸æµç¨‹

### è‡ªåŠ¨å®¡æ ¸è§„åˆ™

1. **å†…å®¹è¿‡æ»¤**: æ£€æŸ¥æ˜¯å¦åŒ…å«æ•æ„Ÿè¯æ±‡
2. **é¢‘ç‡é™åˆ¶**: åŒä¸€IPæ¯åˆ†é’Ÿæœ€å¤šå‘è¡¨5æ¡è¯„è®º
3. **é•¿åº¦éªŒè¯**: è¯„è®ºå†…å®¹å¿…é¡»åœ¨10-1000å­—ç¬¦ä¹‹é—´

### å®¡æ ¸çŠ¶æ€æµè½¬

```
æäº¤è¯„è®º â†’ å¾…å®¡æ ¸(is_pass=false, is_read=false)
            â†“
         è‡ªåŠ¨å®¡æ ¸
            â†“
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â†“                   â†“
é€šè¿‡å®¡æ ¸              äººå·¥å®¡æ ¸
(is_pass=true)       (is_read=false)
    â†“                   â†“
å…¬å¼€æ˜¾ç¤º              ç®¡ç†å‘˜å¤„ç†
                    â†“
                å®¡æ ¸é€šè¿‡/æ‹’ç»
```

### é€šçŸ¥æœºåˆ¶

1. **æ–°è¯„è®ºé€šçŸ¥**: å½“æœ‰æ–°è¯„è®ºæ—¶ï¼Œå‘é€é‚®ä»¶é€šçŸ¥æ–‡ç« ä½œè€…
2. **å®¡æ ¸é€šçŸ¥**: è¯„è®ºé€šè¿‡å®¡æ ¸åï¼Œå¯é€‰æ‹©é€šçŸ¥è¯„è®ºè€…
3. **å›å¤é€šçŸ¥**: å¦‚æœæ˜¯å›å¤è¯„è®ºï¼Œé€šçŸ¥åŸè¯„è®ºè€…

## é™æµè§„åˆ™

| æ“ä½œ | é™æµè§„åˆ™ | æ—¶é—´çª—å£ |
|------|----------|----------|
| æ·»åŠ è¯„è®º | æ¯IP 5æ¬¡ | 1åˆ†é’Ÿ |
| æ·»åŠ è¯„è®º | æ¯IP 50æ¬¡ | 1å°æ—¶ |
| è·å–è¯„è®ºåˆ—è¡¨ | æ¯IP 100æ¬¡ | 1åˆ†é’Ÿ |

## å†…å®¹è§„èŒƒ

### å…è®¸çš„å†…å®¹

- æŠ€æœ¯ç›¸å…³çš„è®¨è®ºå’Œé—®é¢˜
- å»ºè®¾æ€§çš„æ„è§å’Œå»ºè®®
- ç»éªŒåˆ†äº«å’Œè¡¥å……è¯´æ˜
- ç¤¼è²Œçš„æ„Ÿè°¢å’Œé¼“åŠ±

### ç¦æ­¢çš„å†…å®¹

- æ¶æ„æ”»å‡»å’Œäººèº«æ”»å‡»
- å¹¿å‘Šå’Œåƒåœ¾ä¿¡æ¯
- æ”¿æ²»æ•æ„Ÿå†…å®¹
- è¿æ³•è¿è§„å†…å®¹
- ä¸æ–‡ç« å†…å®¹æ— å…³çš„ä¿¡æ¯

### è¯„è®ºæ ¼å¼å»ºè®®

- å­—æ•°ï¼š10-1000å­—ç¬¦
- æ”¯æŒå°‘é‡Markdownæ ¼å¼ï¼ˆç²—ä½“ã€æ–œä½“ã€é“¾æ¥ï¼‰
- ä¸æ”¯æŒHTMLæ ‡ç­¾ï¼ˆä¼šè¢«è‡ªåŠ¨è¿‡æ»¤ï¼‰
- å»ºè®®åˆ†æ®µï¼Œæé«˜å¯è¯»æ€§

## æ³¨æ„äº‹é¡¹

1. **åŒ¿åè¯„è®º**: æœªç™»å½•ç”¨æˆ·å¯ä»¥åŒ¿åè¯„è®ºï¼Œä½†éœ€è¦æä¾›é‚®ç®±
2. **å®¡æ ¸å»¶è¿Ÿ**: è¯„è®ºå¯èƒ½éœ€è¦å‡ åˆ†é’Ÿåˆ°å‡ å°æ—¶çš„å®¡æ ¸æ—¶é—´
3. **è¯„è®ºä¿®æ”¹**: æäº¤åæ— æ³•ä¿®æ”¹ï¼Œè¯·ä»”ç»†æ£€æŸ¥å†…å®¹
4. **éšç§ä¿æŠ¤**: ç”¨æˆ·çš„IPåœ°å€ç­‰ä¿¡æ¯ä»…ç”¨äºå®‰å…¨å®¡æ ¸ï¼Œä¸ä¼šå…¬å¼€
5. **åˆ é™¤æƒé™**: ä½œè€…å’Œç³»ç»Ÿç®¡ç†å‘˜å¯ä»¥åˆ é™¤ä¸å½“è¯„è®º

## ç›¸å…³é”™è¯¯ç 

| é”™è¯¯ç  | æè¿° | è§£å†³æ–¹æ¡ˆ |
|--------|------|----------|
| 20301 | æ·»åŠ è¯„è®ºå¤±è´¥ | æ£€æŸ¥æ–‡ç« æ˜¯å¦å­˜åœ¨ï¼Œè¯„è®ºå†…å®¹æ˜¯å¦ç¬¦åˆè§„èŒƒ |
| 20302 | è·å–è¯„è®ºåˆ—è¡¨å¤±è´¥ | æœåŠ¡å™¨å†…éƒ¨é”™è¯¯ï¼Œè¯·ç¨åé‡è¯• |
| 20101 | å‚æ•°é”™è¯¯ | æ£€æŸ¥è¯·æ±‚å‚æ•°æ ¼å¼ |
| 429 | è¯·æ±‚è¿‡äºé¢‘ç¹ | é™ä½è¯·æ±‚é¢‘ç‡ï¼Œéµå®ˆé™æµè§„åˆ™ |

---

ğŸ’¡ **æç¤º**: è¯„è®ºåŠŸèƒ½ä¸»è¦ç”¨äºæŠ€æœ¯äº¤æµï¼Œè¯·éµå®ˆç¤¾åŒºè§„èŒƒï¼Œè¥é€ è‰¯å¥½çš„è®¨è®ºç¯å¢ƒã€‚